<% layout('/layout/boilerplate') -%>


    <div id='cluster-map'></div>


    <h1>All LEED Projects</h1>
    <a href="/projects/new">Add A New LEED Project</a>
    <p class='text-muted'> You viewed this page
        <%= views %> times
    </p>

    <ul class="px-0">
        <% for(project of projects){ %>

            <div class="card mb-3">
                <div class="row">
                    <% if(project.images.length!==0){ %>
                        <div class="col-md-4">
                            <img class='img-fluid' src="<%=project.images[0].url%> " alt="">
                        </div>
                        <% } else{%>
                            <div class="col-md-4">
                                <img class='img-fluid' src="" alt="">
                            </div>
                            <% } %>
                                <div class="col-md-8">
                                    <div class="card-body">
                                        <h5 class="card-title">
                                            <%=project.name%>
                                        </h5>
                                        <p class='card-text'>
                                            <%= project.description %>
                                        </p>
                                        <p class='card-text'>
                                            <small class="text-muted">
                                                <%=project.location%>
                                            </small>
                                        </p>

                                        <a class='btn btn-info btn-sm' href="/projects/<%= project._id %> ">View <%=project.name%></a>
                                    </div>
                                </div>
                </div>
            </div>
            <% } %>
    </ul>
    <script>
        const mapBoxToken = '<%=process.env.MAPBOX_TOKEN%>';  // instead of hardcoding the token. Centralize the token
        const projects ={features:<%-JSON.stringify(projects) %>} 
    </script>
    <script src="/javascripts/clusterMap.js"></script>